{% extends 'itop-portal-base/portal/templates/bricks/tile.html.twig' %}

{% set name = 'communication' %}
{% set isInlineTitle = true %}
{% set classes = 'carousel' %}
{% set attr = 'data-ride=carousel data-role=tile-navigation-trigger tabindex=0 data-items-count=' ~ message_count %}
{% set sModalId = 'communication-modal-' ~ brick.GetId %}

{% block pTileExtraContent %}

    {# carousel indicators #}
    {% if message_count > 1 %}
        <ol class="carousel-indicators">
            {% for message in messages %}
                <li data-target="#{{ id }}" data-slide-to="{{ loop.index0 }}"
                    class="{% if loop.index0 == 0 %}active{% endif %} {{ message.Get('icon') }}"></li>
            {% endfor %}
        </ol>
    {% endif %}

    {# carousel inner #}
    <div class="carousel-inner" role="listbox">
        {% for message in messages %}
            <div class="ipb-tile-communication--item item{% if loop.index0 == 0 %} active{% endif %}"
                 data-item-title="{{ message.Get('title') }}"
                 data-item-icon="{{ message.Get('icon') }}"
                 data-item-icon-class="{{ message.GetFontAwesomeIcon() }}"
                 data-item-number="{{ loop.index0 + 1 }}"
            >
                {{ message.GetAsHTML('message') | raw }}
            </div>
        {% endfor %}
    </div>

{% endblock %}

{% block pTileModal %}
    <div id="{{ sModalId }}" class="ipb-modal--communication modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header"
                     style="background-color: whitesmoke;">
                    <div style="display: flex;justify-content: space-between;align-items: center;">
                        <h4 class="modal-title" style="color: #515151; font-weight: 600;"></h4>
                        <div>
                            <button class="btn btn-secondary ipb-button--prev"><span
                                        class="fas fa-chevron-left"></span></button>
                            <button class="btn btn-secondary ipb-button--next"><span
                                        class="fas fa-chevron-right"></span></button>
                            <button class="btn btn-secondary ipb-button--close" data-dismiss="modal"><span
                                        class="fas fa-times"></span></button>
                        </div>
                    </div>
                </div>
                <div class="modal-body">
                    <p></p>
                </div>
                <div class="modal-footer" style="background-color: whitesmoke;">
                    <div style="display: flex;justify-content: space-between;">
                        <div>
                            <span>Communication </span>
                            <span data-role="carousel-modal--message-count">Communication</span>
                        </div>
                        <button type="button" class="btn btn-default"
                                data-dismiss="modal">{{ 'UI:Button:Ok'|dict_s }}</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block pTileJsComponent %}
    new IpbTileCarousel('{{ id }}', '{{ name }}', '{{ sModalId }}');
{% endblock %}

{% block pTileActions %}
    <button class="btn btn-secondary ipb-button--prev"><span class="glyphicon glyphicon-chevron-left"></span></button>
    <button class="btn btn-secondary ipb-button--next"><span class="glyphicon glyphicon-chevron-right"></span></button>
{% endblock %}
